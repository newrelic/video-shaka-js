<!DOCTYPE html>
<html>
  <head>
    <!-- newrelic tracker -->
    <script src="../dist/umd/newrelic-video-shaka.min.js"></script>

    <!-- shaka -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/shaka-player/4.11.2/shaka-player.compiled.debug.min.js"></script>
  </head>
  <body>
    <video
      id="myPlayer"
      width="640"
      height="480"
      crossorigin="anonymous"
      controls
    ></video>
    <script>
      async function initPlayer() {
        // Install polyfills.
        shaka.polyfill.installAll();

        // Find the video element.
        var video = document.getElementById('myPlayer');

        // Construct a Player to wrap around it.

        var player = new shaka.Player(video);

        // Attach the player to the window so that it can be easily debugged.
        window.player = player;

        // source
        var source = 'https://turtle-tube.appspot.com/t/t2/dash.mpd';

        try {
          window.player = player;
          await player.load(source);
          // newrelic

          const options = {
            info: {
              beacon: 'bam.nr-data.net',
              licenseKey: 'NRBR-298f449004b949aad61',
              applicationID: '601579909',
            },
          };

          var tracker = new ShakaTracker(player, options);
        } catch (error) {
          console.error(error.message);
        }
      }

      document.addEventListener('DOMContentLoaded', initPlayer);
    </script>
  </body>
</html>
